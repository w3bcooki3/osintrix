<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OSINTrix - Investigation Tool</title>
    <link rel="stylesheet" href="./styles/main.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  </head>
  <body class="light-theme">
    <header class="app-header">
      <div class="logo">
        <i class="fas fa-project-diagram"></i>
        <div class="logo-text">
          <h1>OSINTrix</h1>
          <p class="tagline">Map networks. Trace threats. Solve the unknown.</p>
        </div>
      </div>
      <div class="toolbar">
        <button id="new-node-btn" class="btn-primary">
          <i class="fas fa-plus"></i> New Node
        </button>
        <button id="new-edge-btn" class="btn-secondary">
          <i class="fas fa-link"></i> New Connection
        </button>
        <div class="search-container">
          <input type="text" id="search-input" placeholder="Search entities...">
          <i class="fas fa-search"></i>
        </div>
        <div class="toolbar-actions">
          <button id="save-btn" class="btn-icon" title="Save Investigation">
            <i class="fas fa-save"></i>
          </button>
          <button id="load-btn" class="btn-icon" title="Load Investigation">
            <i class="fas fa-folder-open"></i>
          </button>
          <button id="export-btn" class="btn-icon" title="Export as JSON">
            <i class="fas fa-file-export"></i>
          </button>
          <button id="import-btn" class="btn-icon" title="Import JSON">
            <i class="fas fa-file-import"></i>
          </button>
          <button id="theme-toggle" class="btn-icon" title="Toggle Theme">
            <i class="fas fa-moon"></i>
          </button>
        </div>
      </div>
    </header>

    <main class="app-content">
      <div id="graph-container"></div>
      
      <aside id="entity-panel" class="panel hidden">
        <div class="panel-header">
          <h2>Entity Details</h2>
          <button class="btn-icon close-panel">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="panel-content">
          <div id="entity-details"></div>
        </div>
      </aside>

      <aside id="entity-list-panel" class="panel">
        <div class="panel-header">
          <h2>Entities</h2>
          <div class="panel-actions">
            <button id="filter-btn" class="btn-icon" title="Filter Entities">
              <i class="fas fa-filter"></i>
            </button>
            <button class="btn-icon toggle-panel" title="Toggle Panel">
              <i class="fas fa-chevron-left"></i>
            </button>
          </div>
        </div>
        <div class="panel-content">
          <div class="filter-options hidden">
            <div class="filter-group">
              <h3>Entity Types</h3>
              <div class="checkbox-group">
                <label><input type="checkbox" class="entity-type-filter" value="person" checked> Person</label>
                <label><input type="checkbox" class="entity-type-filter" value="organization" checked> Organization</label>
                <label><input type="checkbox" class="entity-type-filter" value="wallet" checked> Wallet</label>
                <label><input type="checkbox" class="entity-type-filter" value="ip" checked> IP Address</label>
                <label><input type="checkbox" class="entity-type-filter" value="location" checked> Location</label>
                <label><input type="checkbox" class="entity-type-filter" value="transaction" checked> Transaction</label>
                <label><input type="checkbox" class="entity-type-filter" value="social" checked> Social Media</label>
                <label><input type="checkbox" class="entity-type-filter" value="domain" checked> Domain</label>
                <label><input type="checkbox" class="entity-type-filter" value="website" checked> Website</label>
              </div>
            </div>
          </div>
          <ul id="entity-list" class="entity-list"></ul>
        </div>
      </aside>

      <aside id="notes-panel" class="panel">
        <div class="panel-header">
          <h2>Investigation Notes</h2>
          <div class="panel-actions">
            <button class="btn-icon toggle-panel" title="Toggle Panel">
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </div>
        <div class="panel-content">
          <textarea id="investigation-notes" placeholder="Enter your investigation notes here..."></textarea>
          <button id="save-notes" class="btn-primary">Save Notes</button>
        </div>
      </aside>
    </main>

    <!-- Context Menu -->
    <div id="context-menu" class="context-menu hidden">
      <ul>
        <li data-action="edit"><i class="fas fa-edit"></i> Edit</li>
        <li data-action="connect"><i class="fas fa-link"></i> Connect</li>
        <li data-action="delete"><i class="fas fa-trash"></i> Delete</li>
        <li data-action="highlight"><i class="fas fa-highlighter"></i> Highlight</li>
      </ul>
    </div>

    <!-- Modals -->
    <div id="node-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="node-modal-title">Add New Node</h2>
          <button class="btn-icon close-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="node-form">
            <div class="form-group">
              <label for="node-type">Type</label>
              <select id="node-type" required>
                <option value="person">Person</option>
                <option value="organization">Organization</option>
                <option value="wallet">Wallet Address</option>
                <option value="ip">IP Address</option>
                <option value="location">Location</option>
                <option value="transaction">Transaction ID</option>
                <option value="social">Social Media</option>
                <option value="domain">Domain</option>
                <option value="website">Website</option>
              </select>
            </div>
            <div class="form-group">
              <label for="node-label">Label</label>
              <input type="text" id="node-label" required placeholder="Enter label">
            </div>
            <div class="form-group">
              <label for="node-description">Description</label>
              <textarea id="node-description" placeholder="Enter description"></textarea>
            </div>
            <div class="form-row">
              <div class="form-group half">
                <label for="node-date">Date</label>
                <input type="date" id="node-date">
              </div>
              <div class="form-group half">
                <label for="node-time">Time</label>
                <input type="time" id="node-time">
              </div>
            </div>
            <div class="form-group">
              <label for="node-location">Location</label>
              <input type="text" id="node-location" placeholder="Enter location">
            </div>
            <div class="form-group">
              <label for="node-tags">Tags (comma separated)</label>
              <input type="text" id="node-tags" placeholder="tag1, tag2, tag3">
            </div>
            <div class="form-group">
              <label for="node-notes">Notes</label>
              <textarea id="node-notes" placeholder="Enter notes"></textarea>
            </div>
            <div class="form-group">
              <label for="node-image">Image</label>
              <div class="image-upload-container">
                <div id="image-preview"></div>
                <input type="file" id="node-image" accept="image/*">
                <button type="button" id="browse-image" class="btn-secondary">Browse Image</button>
                <button type="button" id="remove-image" class="btn-text hidden">Remove</button>
              </div>
            </div>
            <div class="form-group">
              <h3>Additional Metadata</h3>
              <div id="metadata-fields">
                <!-- Dynamic metadata fields will be added here -->
              </div>
              <button type="button" id="add-metadata" class="btn-text">
                <i class="fas fa-plus"></i> Add Field
              </button>
            </div>
            <div class="form-actions">
              <button type="button" class="btn-secondary cancel-modal">Cancel</button>
              <button type="submit" class="btn-primary">Save</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div id="edge-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="edge-modal-title">Add New Connection</h2>
          <button class="btn-icon close-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="edge-form">
            <div class="form-group">
              <label for="source-node">Source</label>
              <select id="source-node" required>
                <!-- Options will be populated dynamically -->
              </select>
            </div>
            <div class="form-group">
              <label for="target-node">Target</label>
              <select id="target-node" required>
                <!-- Options will be populated dynamically -->
              </select>
            </div>
            <div class="form-group">
              <label for="edge-label">Relationship Label</label>
              <input type="text" id="edge-label" required placeholder="e.g., owns, knows, sent to">
            </div>
            <div class="form-group">
              <label for="edge-description">Description</label>
              <textarea id="edge-description" placeholder="Enter description"></textarea>
            </div>
            <div class="form-group">
              <label for="edge-notes">Notes</label>
              <textarea id="edge-notes" placeholder="Enter notes"></textarea>
            </div>
            <div class="form-actions">
              <button type="button" class="btn-secondary cancel-modal">Cancel</button>
              <button type="submit" class="btn-primary">Save</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <input type="file" id="import-input" accept=".json" class="hidden">
    <a id="export-link" class="hidden"></a>

    <script type="module" src="/main.js"></script>
  </body>
</html>